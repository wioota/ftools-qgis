<?xml version="1.0"?>
<manageRTools>
<RTool name="Insert random R commands" query="|1|">
<Parameter label="R commands:" type="textEdit" default="ls()" notnull="true"/>
</RTool>
<RTool name="Voronoi polygons" query="
voronoipolygons &lt;- function(layer){&#xA;
  require(deldir)&#xA;
  crds &lt;- layer@coords&#xA;
  z &lt;- deldir(crds[,1], crds[,2])&#xA;
  w &lt;- tile.list(z)&#xA;
  polys &lt;- vector(mode='list', length=length(w))&#xA;
  require(sp)&#xA;
  for (i in seq(along=polys)) {&#xA;
    pcrds &lt;- cbind(w[[i]]$x, w[[i]]$y)&#xA;
    pcrds &lt;- rbind(pcrds, pcrds[1,])&#xA;
    polys[[i]] &lt;- Polygons(list(Polygon(pcrds)), ID=as.character(i))&#xA;
  }&#xA;
  SP &lt;- SpatialPolygons(polys)&#xA;
  voronoi &lt;- SpatialPolygonsDataFrame(SP, data=data.frame(x=crds[,1], &#xA;
  y=crds[,2], row.names=sapply(slot(SP, 'polygons'), function(x) slot(x, 'ID'))))&#xA;
}&#xA;
|1|.voronoi &lt;- voronoipolygons(|1|)">
<Parameter label="Point layer:" type="spComboBox" default="SpatialPointsDataFrame" notnull="true"/>
</RTool>
<RTool name="Polygon centroids" query="
polygoncentroids &lt;- function(layer){&#xA;
  proj &lt;- proj4string(layer)&#xA;
  coords &lt;- coordinates(layer)&#xA;
  attrs &lt;- layer@data&#xA;
  centroids &lt;- SpatialPointsDataFrame(coords=coords, &#xA;
  data=attrs, proj4string=CRS(proj))&#xA;
}&#xA;
|1|.centroids &lt;- polygoncentroids(|1|)">
<Parameter label="Polygon layer:" type="spComboBox" default="SpatialPolygonsDataFrame" notnull="true"/>
</RTool>
<RTool name="Spatial weights" query="
computeweights &lt;- function(layer, decay, style, type, value){&#xA;
    #require(rgdal)&#xA;
    #require(Matrix)&#xA;
    require(spdep)&#xA;
    if (type == 'CONTIG') {&#xA;
        weights = poly2nb(pl=layer, snap=0.0005, queen=T) #Better parameter for snap?&#xA;
        if (value >= 2)&#xA;
            weights &lt;- nblag_cumul(nblags=nblag(neighbours=weights, maxlag=value))&#xA;
    } else {&#xA;
        ids &lt;- seq(dim(layer)[1])-1&#xA;
        proj &lt;- proj4string(layer)&#xA;
        coords &lt;- coordinates(obj=layer)&#xA;
        output &lt;- SpatialPoints(coords=coords, proj4string=CRS(proj))&#xA;
        if (type == 'DIST')&#xA;
            dist &lt;- dnearneigh(x=output, d1=0, d2=value, row.names=ids)&#xA;
        else # 'KNEAR'&#xA;
            dist &lt;- knn2nb(knn=knearneigh(x=output, k=value), row.names=ids, sym=F)&#xA;
        dlist &lt;- nbdists(nb=dist, coords=output)&#xA;
        idlist &lt;- lapply(X=dlist, FUN=function(x) 1/(x**decay))&#xA;
        weights &lt;- nb2listw(neighbours=dist, glist=idlist, style=style, zero.policy=T)&#xA;
    }&#xA;
}&#xA;
|1|.weights &lt;- computeweights(|1|, |2|, |3|, |4|, |5|)">
<Parameter label="Layer:" type="spComboBox" default="
SpatialPolygonsDataFrame;SpatialPointsDataFrame;SpatialLinesDataFrame" notnull="true"/>
<Parameter label="Decay:" type="doubleSpinBox" default="2.00" notnull="true"/>
<Parameter label="Style:" type="comboBox" default="'W';'B';'C';'U';'S'" notnull="true"/>
<Parameter label="Type:" type="comboBox" default="'CONTIG';'DIST';'KNEAR'" notnull="true"/>
<Parameter label="Value:" type="doubleSpinBox" default="5.00" notnull="true"/>
<Parameter label="help" type="helpString" default="
This is a help string for an R plugin" notnull="true"/>
</RTool>
</manageRTools>